package system.cli.api;

/**
 * Backend-поток — аналог backend-процесса PostgreSQL.
 *
 * Задача:
 * - обслуживать ОДНО конкретное клиентское соединение (один Socket);
 * - читать строки запросов от клиента;
 * - передавать их в Engine;
 * - отправлять клиенту текстовый ответ.
 *
 * Обычно каждая реализация BackendWorker будет работать в отдельном потоке:
 * new Thread(new BackendWorkerImpl(...)).start();
 */
public interface BackendWorker extends Runnable {

    /**
     * Основной цикл обработки клиента.
     *
     * Ожидаем типичный сценарий:
     * - отправить приветственное сообщение при подключении;
     * - в цикле:
     *     - прочитать строку запроса;
     *     - если "exit"/"quit" -> аккуратно закрыть соединение;
     *     - если пустая строка -> отправить маркер конца ответа (__END__);
     *     - иначе вызвать engine.executeSql(...) и отправить результат построчно;
     *     - в конце каждого ответа отправить строку-маркер "__END__".
     *
     * Реализация должна корректно закрывать сокет и потоки ввода/вывода.
     */
    @Override
    void run();
}